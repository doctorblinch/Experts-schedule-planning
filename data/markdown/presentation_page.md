# Задача про експертів

Виконали студенти групи **ІС-72**

**Гороховський Іван** *і* **Лиховський Дмитро**

---

## Умова задачі
Деяка фірма планує запросити до себе експертів. 
Кожен з експертів вказав дві дати: початок і кінець інтервалу,
 впродовж якого він може працювати (експерти працюють без 
 вихідних повні робочі дні)
  
Кожен експерт може приїхати тільки один раз. 
Одночасно фірма може прийняти лише одного експерта.

**Скласти** такий розклад роботи експертів, щоб *сумарна 
кількість днів* їх роботи *була максимальною*.

---

## Аналіз задачі
**Цільова функція**

$$Z = \sum_{i=1}^{n} (e_i - b_i)x_i \rightarrow{max}$$

Максимізувати сумарну кількість днів в які працюють експерти.

**Обмеження**

Умова не накладання - для кожного з обраних експертів ($x_i$ = 1) 
початок роботи наступного експерту якого ми беремо не може 
початись раніше ніж кінець роботи поточного експерта.

Щоб нерівність нижче ставала рівністю, ліва частина повинна 
дорівнювати двійці, а це досягається тільки коли $x_i$ = 1 та $x_j$ = 1, 
а права частина (там де sign) повинна дорівнювати -1, а це 
досягається тільки тоді, коли відрізки перетинаються. Мале число m в даному 
виразі є число-регулювальник, для випадку коли , це означає що відрізки все ж 
таки перетинаються і це мале число дасть всьому виразу від’ємний знак і завдяки 
цьому умова не порушиться.

$$(x_i + x_j) * sign((e_i - e_j)( b_i - b_j) - m) ≠ -2$$

∀  i ≠ j ∀ i, m – дуже мале число   

**Опис алгоритмів**

## 2.3 Розробка алгоритмів розв’язання задачі
### 2.3.1 Жадібний алгоритм
**Опис алгоритму:**
На кожному кроці потрібно додавати до поточного проміжного 
розв’язку такого експерта, який буде покривати максимальну 
кількість днів, які ще не зайняті іншим обраним експертом.

### 2.3.2 Рекурсивний оптимізатор проміжків
**Опис алгоритму:**
Знайдемо найбільший проміжок в якому при поточному розв’язку
не працюють експерти. Маємо експерта зліва, експерта 
справа і проміжок між ними. Спробуємо замінити спочатку 
експерта зліва на 2 інших експертів займаючи проміжок часу
лівого експерта і час проміжку, якщо існують такі 2 інших
експерта сумарний час яких більше ніж час лівого експерта
– то в поточному рішенні замінюємо лівого експерта на 
нових 2. 

Аналогічну операцію робимо для правого 
експерта. Даний процес є ітеративним, отже його можна 
продовжувати до моменту поки ми отримуємо приріст до 
цільової функції, до моменту поки ми можемо покращити
розв’язок чи до моменту коли отримані проміжки будуть 
менші за деяке задане натуральне K  або просто обмежити кількість ітерацій деякою константою.

### 2.3.3 Алгоритм із використанням методів динамічного програмування
**Опис алгоритму:**
Припустимо, що графік роботи експертів відсортований в порядку неспадання 
кінцевого часу:  $e_1 ≤ e_2 ≤ ... ≤ e_n$. Тепер розглянемо роботу двух експертів: i та j. 
Припустимо, що i < j означає  $e_i ≤ b_j$, тобто інтервали двох експертів не перетинаються 
та інтервал i закінчується до початку інтервалу j. 

Визначимо функцію compute_previous_intervals(), що для кожного експерту j 
обчислює значення $p_j$ - найбільш правого взаємно сумісного експерта i, де

$a_{ie}$ < $a_{jb}$

Розглянемо оптимальний розв’язок О. Ми не знаємо, як він виглядає, але ми можемо 
припустити, що робота останнього експерта n є частиною оптимального розв’язку чи ні.

Припустимо, що n ∈ O:

Якщо n - частина оптимального розв'язку O, то ми можемо бути впевнені, що жоден 
експерт між $p_n$ та n не може бути частиною O (тому що всі інтервали експертів в 
цьому діапазоні будуть перетинатися з n). Отже, якщо  n ∈ O, ми можемо відкинути 
інтервали  $p_{n+1}$
, $p_{n+2}$
, ... $p_{n-1}$
. Також якщо n ∈ O, то і оптимальний розв'язок 
O повинен включати в себе також оптимальний розв'зок задачі 1 … $p_n$. Тобто, якщо O є 
оптимальним розв'язком і n ∈ O, то O можна розділити на n і оптимальний 
розв'язок з набору експертів 1 … $p_n$ .
    
Припустимо, що n ∉ O:
    
Якщо n ∉ O, то наш оптимальний розв'язок дорівнює оптимальному
 розв'язку меншої задачі, що складається з експертів 
 1 … n − 1. Тобто, якщо n не є частиною оптимального 
 розв'язку, то шукаємо такий розв'язок в меншій множині, 
 що складається з експертів 1 … n − 1.
 
Можна прийти до висновку, що для того, щоб знайти оптимальний
 розв'язок O (для n елементів), ми повинні розглянути більш
  дрібні та менші задачі у вигляді 1 … j. Позначимо такий 
  оптимальний розв'язок на множині експертів 1 … j як , а 
  максимальну кількість зайнятого експертами часу $OPT_j$. Отже, 
  для будь-якого j маємо таку саму дихотомію: або j ∈ Oj, 
  або           j ∉ Oj, тому можна стверджувати, що:

$$OPT_j = max(a_{je} - a_{jb} + OPT_{pj}, OPT_{j-1})$$

І з цього випливає, що деякий довільний експерт j є частиною оптимального 
розв'язку  тоді і тільки тоді: 

$$a_{je} - a_{jb} + OPT_{pj} ≥ OPT_{j-1}$$